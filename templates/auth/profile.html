{% extends "index.html" %}

{% block title %}Profile{% endblock %}

{% block main_content %}
<div class="profile-container">
  <header class="profile-header">
    <h1><i class="fas fa-user"></i> User Profile</h1>
    <p>Manage your account settings and view your activity</p>
  </header>

  <!-- User Information Card -->
  <section class="card profile-info-card">
    <div class="profile-info-header">
      <h2><i class="fas fa-id-card"></i> Account Information</h2>
      <a href="{{ url_for('edit_profile') }}" class="btn btn-secondary">
        <i class="fas fa-edit"></i> Edit Profile
      </a>
    </div>

    <div class="profile-info-content">
      <div class="profile-avatar">
        <i class="fas fa-user-circle"></i>
      </div>
      <div class="profile-details">
        <div class="detail-item">
          <label>Full Name:</label>
          <span>{{ current_user.get_full_name() }}</span>
        </div>
        <div class="detail-item">
          <label>Username:</label>
          <span>{{ current_user.username }}</span>
        </div>
        <div class="detail-item">
          <label>Email:</label>
          <span>{{ current_user.email }}</span>
        </div>
        <div class="detail-item">
          <label>Member Since:</label>
          <span>{{ current_user.created_at.strftime('%B %d, %Y') if current_user.created_at else 'Unknown' }}</span>
        </div>
        <div class="detail-item">
          <label>Last Login:</label>
          <span>{{ current_user.last_login.strftime('%B %d, %Y at %I:%M %p') if current_user.last_login else 'Never'
            }}</span>
        </div>
        {% if current_user.is_admin %}
        <div class="detail-item">
          <label>Role:</label>
          <span class="admin-badge"><i class="fas fa-crown"></i> Administrator</span>
        </div>
        {% endif %}
      </div>
    </div>
  </section>

  <!-- Account Actions -->
  <section class="card profile-actions-card">
    <h2><i class="fas fa-cogs"></i> Account Actions</h2>
    <div class="profile-actions">
      <a href="{{ url_for('change_password') }}" class="action-btn">
        <i class="fas fa-lock"></i>
        <div>
          <h3>Change Password</h3>
          <p>Update your account password</p>
        </div>
      </a>
      <a href="{{ url_for('check_history') }}" class="action-btn">
        <i class="fas fa-history"></i>
        <div>
          <h3>Check History</h3>
          <p>View your plagiarism check history</p>
        </div>
      </a>
      <a href="{{ url_for('index') }}" class="action-btn">
        <i class="fas fa-search"></i>
        <div>
          <h3>New Check</h3>
          <p>Perform a new plagiarism check</p>
        </div>
      </a>
    </div>
  </section>

  <!-- Recent Activity -->
  <section class="card profile-activity-card">
    <div class="activity-header">
      <h2><i class="fas fa-clock"></i> Recent Activity</h2>
      <a href="{{ url_for('check_history') }}" class="btn btn-outline">
        <i class="fas fa-list"></i> View All
      </a>
    </div>

    {% if checks %}
    <div class="activity-list">
      {% for check in checks %}
      <div class="activity-item">
        <div class="activity-icon">
          <i
            class="fas fa-{% if check.check_type == 'pairwise' %}exchange-alt{% elif check.check_type == 'multiple' %}list{% else %}tag{% endif %}"></i>
        </div>
        <div class="activity-content">
          <div class="activity-title">
            {{ check.check_type.title() }} Plagiarism Check
            {% if check.file_name %}
            <span class="file-indicator">
              <i class="fas fa-file"></i> {{ check.file_name }}
            </span>
            {% endif %}
          </div>
          <div class="activity-meta">
            <span class="activity-score">
              <i class="fas fa-percentage"></i>
              {{ "%.1f" | format(check.plagiarism_score * 100) }}% plagiarism
            </span>
            <span class="activity-matches">
              <i class="fas fa-search"></i>
              {{ check.total_matches }} matches
            </span>
            <span class="activity-date">
              <i class="fas fa-calendar"></i>
              {{ check.created_at.strftime('%b %d, %Y') }}
            </span>
          </div>
        </div>
        <div
          class="activity-score-badge {{ 'high' if check.plagiarism_score > 0.7 else 'medium' if check.plagiarism_score > 0.3 else 'low' }}">
          {{ "%.0f" | format(check.plagiarism_score * 100) }}%
        </div>
      </div>
      {% endfor %}
    </div>
    {% else %}
    <div class="no-activity">
      <i class="fas fa-clipboard-list"></i>
      <h3>No Recent Activity</h3>
      <p>You haven't performed any plagiarism checks yet.</p>
      <a href="{{ url_for('index') }}" class="btn btn-primary">
        <i class="fas fa-plus"></i> Start Your First Check
      </a>
    </div>
    {% endif %}
  </section>
</div>
{% endblock %}